<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      td span {
        font-size: 0.8em;
        color: red;
        padding: 5px;
        cursor: pointer;
      }
      td:first-child {
        width: 250px;
        overflow: hidden;
      }
    </style>
  </head>
  <body>
    <div class="output"></div>
    <input type="text" name="" id="addItem" />
    <input type="button" value="Add Item" id="addNew" />
    <script>
      let myList = ["bannanas", "milk", "apples", "eggs", "cake"];
      const btnAdd = document.querySelector("#addNew");
      const output = document.querySelector(".output");
      const newItem = document.querySelector("#addItem");
      btnAdd.addEventListener("click", function () {
        // console.log("clicked");
        if (newItem.value) {
          myList.push(newItem.value);
        }
        build();
        newItem.value = "";
      });

      document.addEventListener("DOMContentLoaded", build()); // Invoke build function
      function build() {
        output.innerHTML = "<h2>My List</h2>";
        console.log("ready");
        const tbl = document.createElement("table");
        for (let i = 0; i < myList.length; i++) {
          const row = document.createElement("tr");
          row.ind = i;
          const cell1 = document.createElement("td");
          cell1.innerHTML = myList[i];
          row.appendChild(cell1);
          const cell2 = document.createElement("td");
          const span1 = document.createElement("span");
          span1.innerText = "Delete";
          cell2.appendChild(span1);
          span1.addEventListener("click", function () {
            // console.log(myList[i]);
            //let temp = this.closest("tr").ind; Way to navigate using JS
            //console.log(temp);
            let itemOut = myList.splice(i, 1);
            // console.log(myList);
            build(); //Rebuild the list
          });

          const span2 = document.createElement("span");
          span2.innerText = "Edit";
          span2.addEventListener("click", function () {
            row.style.backgroundColor = "Yellow";
            let tempElement = row.firstElementChild;

            const newInput = document.createElement("input");
            newInput.value = tempElement.innerText;
            newInput.focus();
            tempElement.innerHTML = "";
            tempElement.appendChild(newInput);
            newInput.addEventListener("blur", function () {
              tempElement.innerHTML = newInput.value;
              row.style.backgroundColor = "White";
              myList[i] = newInput.value;
              build();
            });

            //  console.log(tempElement);
          });
          cell2.appendChild(span2);
          row.appendChild(cell2);
          tbl.appendChild(row);
        }

        //   console.log(tbl);
        output.appendChild(tbl);
      }
    </script>
  </body>
</html>
